<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Migrations>
  <Migration EntityType="U" Name="Correct result value type in ContextInfo count" ReleaseNo="3.9.4" SeqNo="7840">
    <Comments>https://github.com/adempiere/adempiere/issues/3489</Comments>
    <Step SeqNo="10" StepType="AD">
      <PO AD_Table_ID="54438" Action="U" Record_ID="50000" Table="AD_ContextInfo">
        <Data AD_Column_ID="88912" Column="SQLStatement" oldValue="SELECT COUNT(*) AS Lines, o.TotalLines, o.GrandTotal, c.ISO_Code,  currencyBase(o.GrandTotal,o.C_Currency_ID,o.DateAcct, o.AD_Client_ID,o.AD_Org_ID) AS ConvAmt &#10;FROM C_Order o &#10;INNER JOIN C_Currency c ON (o.C_Currency_ID=c.C_Currency_ID) &#10;INNER JOIN C_OrderLine l ON (o.C_Order_ID=l.C_Order_ID) &#10;WHERE o.C_Order_ID=@C_Order_ID@&#10;GROUP BY o.C_Currency_ID, c.ISO_Code, o.TotalLines, o.GrandTotal, o.DateAcct, o.AD_Client_ID, o.AD_Org_ID">SELECT CAST(COUNT(*) AS INT) AS Lines, o.TotalLines, o.GrandTotal, c.ISO_Code,  currencyBase(o.GrandTotal,o.C_Currency_ID,o.DateAcct, o.AD_Client_ID,o.AD_Org_ID) AS ConvAmt 
FROM C_Order o 
INNER JOIN C_Currency c ON (o.C_Currency_ID=c.C_Currency_ID) 
INNER JOIN C_OrderLine l ON (o.C_Order_ID=l.C_Order_ID) 
WHERE o.C_Order_ID=@C_Order_ID@
GROUP BY o.C_Currency_ID, c.ISO_Code, o.TotalLines, o.GrandTotal, o.DateAcct, o.AD_Client_ID, o.AD_Org_ID</Data>
      </PO>
    </Step>
    <Step SeqNo="20" StepType="AD">
      <PO AD_Table_ID="54438" Action="U" Record_ID="50001" Table="AD_ContextInfo">
        <Data AD_Column_ID="88912" Column="SQLStatement" oldValue="SELECT COUNT(*), NVL(SUM(LineNetAmt),0), NVL(SUM(LineTotalAmt),0) &#10;FROM C_InvoiceBatchLine &#10;WHERE C_InvoiceBatch_ID=@C_InvoiceBatch_ID@ &#10;AND IsActive='Y'">SELECT CAST(COUNT(*) AS INT), NVL(SUM(LineNetAmt),0), NVL(SUM(LineTotalAmt),0) 
FROM C_InvoiceBatchLine 
WHERE C_InvoiceBatch_ID=@C_InvoiceBatch_ID@ 
AND IsActive='Y'</Data>
      </PO>
    </Step>
    <Step SeqNo="30" StepType="AD">
      <PO AD_Table_ID="54438" Action="U" Record_ID="50002" Table="AD_ContextInfo">
        <Data AD_Column_ID="88912" Column="SQLStatement" oldValue="SELECT COUNT(*) AS Lines, o.TotalLines, o.GrandTotal, c.ISO_Code,  currencyBase(o.GrandTotal,o.C_Currency_ID,o.DateAcct, o.AD_Client_ID,o.AD_Org_ID) AS ConvAmt &#10;FROM C_Invoice o &#10;INNER JOIN C_Currency c ON (o.C_Currency_ID=c.C_Currency_ID) &#10;INNER JOIN C_InvoiceLine l ON (o.C_Invoice_ID=l.C_Invoice_ID)  &#10;WHERE o.C_Invoice_ID=@C_Invoice_ID@&#10;GROUP BY o.C_Currency_ID, c.ISO_Code, o.TotalLines, o.GrandTotal, o.DateAcct, o.AD_Client_ID, o.AD_Org_ID">SELECT CAST(COUNT(*) AS INT) AS Lines, o.TotalLines, o.GrandTotal, c.ISO_Code,  currencyBase(o.GrandTotal,o.C_Currency_ID,o.DateAcct, o.AD_Client_ID,o.AD_Org_ID) AS ConvAmt 
FROM C_Invoice o 
INNER JOIN C_Currency c ON (o.C_Currency_ID=c.C_Currency_ID) 
INNER JOIN C_InvoiceLine l ON (o.C_Invoice_ID=l.C_Invoice_ID)  
WHERE o.C_Invoice_ID=@C_Invoice_ID@
GROUP BY o.C_Currency_ID, c.ISO_Code, o.TotalLines, o.GrandTotal, o.DateAcct, o.AD_Client_ID, o.AD_Org_ID</Data>
      </PO>
    </Step>
    <Step SeqNo="40" StepType="AD">
      <PO AD_Table_ID="54438" Action="U" Record_ID="50003" Table="AD_ContextInfo">
        <Data AD_Column_ID="88912" Column="SQLStatement" oldValue="SELECT COUNT(*) AS Lines, SUM(ConvertedAmt*Qty) &#10;FROM S_TimeExpenseLine &#10;WHERE S_TimeExpense_ID=@S_TimeExpense_ID@">SELECT CAST(COUNT(*) AS INT) AS Lines, SUM(ConvertedAmt*Qty) 
FROM S_TimeExpenseLine 
WHERE S_TimeExpense_ID=@S_TimeExpense_ID@</Data>
      </PO>
    </Step>
  </Migration>
</Migrations>
